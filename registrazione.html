<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pagina-title">Registrazione - Budget Management</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="registrazione-page">
    <div class="container">
        <h1 id="pagina-titolo">Registrazione</h1>
        
        <!-- Nuovi pulsanti per importi -->
        <div id="amount-buttons" class="button-container">
            <!-- Pulsanti per importi -->
        </div>
        
        <!-- Modulo di registrazione -->
        <form id="registrazione-form" action="submit_data.php" method="post">
            <div class="form-group">
                <label for="importo">Importo:</label>
                <input type="text" id="importo" name="importo" required autocomplete="off" placeholder="Inserisci l'importo" pattern="^[0-9]+([.,][0-9]+)?$" title="Inserisci un numero valido (può usare '.' o ',')">
            </div>
            
            <div class="form-group">
                <label for="descrizione">Descrizione (opzionale):</label>
                <input type="text" id="descrizione" name="descrizione" autocomplete="off" placeholder="Inserisci una descrizione">
            </div>

            <div class="form-group">
                <label for="data">Data:</label>
                <input type="date" id="data" name="data" required>
            </div>
            
            <button type="submit" class="submit-button">Registra</button>
        </form>
        
        <!-- Link per tornare alla pagina precedente -->
        <a href="#" class="back-button" id="back-link">INDIETRO</a>
    </div>

    <script>
        // Funzione per ottenere i parametri della query string
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }
    
        // Recupera la categoria dalla query string
        const categoria = getQueryParam('categoria');
        const titolo = document.getElementById('pagina-titolo');
        const titleElement = document.getElementById('pagina-title');
        const backLink = document.getElementById('back-link');
        const amountButtonsContainer = document.getElementById('amount-buttons');
    
        const categoryAmounts = {
            caffe: ['€ 0.33', '€ 0.40', '€ 0.57', '€ 0.60', '€ 0.90'],
            abbonamenti: ['APPLE - € 2.99', 'AMAZON PRIME - € 4.99', 'NETFLIX - € 5.49'],
            svago: ['ORDINE CIBO - € 5.00', 'ORDINE CIBO - € 5.50'],
            trasporti: ['BIGLIETTO BUS - € 1.50', 'BIGLIETTO BUS - € 2.00'],
        };
    
        function setAmountButtons(categoria) {
            const amounts = categoryAmounts[categoria] || [];
            amounts.forEach(amount => {
                const button = document.createElement('a');
                button.href = '#';
                button.textContent = amount;
                button.className = 'amount-button';
                amountButtonsContainer.appendChild(button);
            });
        }
    
        if (categoria) {
            // Converti la categoria per il titolo
            const categoriaCapitalized = categoria.charAt(0).toUpperCase() + categoria.slice(1);
            const newTitle = `Registrazione ${categoriaCapitalized}`;

            // Imposta il titolo della pagina e i pulsanti in base alla categoria
            titolo.textContent = newTitle;
            titleElement.textContent = `${newTitle} - Budget Management`;

            // Setta i pulsanti in base alla categoria, se esistono valori predefiniti
            setAmountButtons(categoria);
        }
    
        // Imposta la data corrente come valore predefinito per il campo data
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('data').value = today;
        });
    
        // Gestione dell'input dell'importo
        document.getElementById('registrazione-form').addEventListener('submit', function(event) {
            let importo = document.getElementById('importo').value;
            // Sostituisce la virgola con il punto per il formato decimale
            importo = importo.replace(',', '.');
            document.getElementById('importo').value = importo;
        });
    
        // Imposta il comportamento del link "INDIETRO" per andare alla pagina precedente
        document.getElementById('back-link').addEventListener('click', function(event) {
            event.preventDefault();
            window.history.back();
        });
    </script>
    
</body>
</html>
